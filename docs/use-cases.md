# D2 — Use-case Narrative

## Use Case 1 — Подбор подарка

### Краткое описание

Пользователь получает персонализированные рекомендации подарков от AI, выбирает подходящий вариант.

### Акторы

- **Пользователь** — основной актор, ищет подарок.
- **AI Engine** — внешний сервис для генерации списка подарков.
- **База данных** — хранение информации о профилях и истории.

### Предусловия

- У пользователя есть доступ к системе.
- Профиль получателя существует в базе данных.

### Основной сценарий (Happy Path)

1. Пользователь открывает главную страницу и видит поле для ввода.
2. Пользователь выбирает аккаунт получателя и вводит уточняющую информацию.
3. Система выполняет локальную валидацию.
4. Система отправляет запрос `POST /api/recommendations`.
5. Система формирует запрос к AI.
6. AI возвращает ранжированный список рекомендаций.
7. Система отображает список пользователю.

### Альтернативные сценарии

- Получатель не найден: Система возвращает `404`, пользователь видит сообщение «Профиль не найден» и может ввести данные вручную.

### Исключения

- Ошибка сети → сообщение «Проверьте интернет».
- Ошибка сервера → сообщение «Попробуйте позже».

### Постусловия

- Пользователь получает список подходящих подарков.
- В базе фиксируется история запроса.

### Критерии приёмки

- Пользователь видит минимум N рекомендаций.
- Ошибки обрабатываются корректно.

---

## Use Case 2 — Регистрация пользователя

### Краткое описание

Пользователь создаёт аккаунт для работы с сервисом.

### Акторы

- **Пользователь** — основной актор.
- **База данных** — хранение данных пользователя.
- **E-mail сервис** — отправка подтверждения.

### Предусловия

- У пользователя нет аккаунта в системе.

### Основной сценарий (Happy Path)

1. Пользователь нажимает «Войти» и выбирает «Нет аккаунта».
2. Вводит email и пароль.
3. Система валидирует поля.
4. Система отправляет `POST /api/user`.
5. Система отправляет подтверждение на email.
6. После подтверждения пользователь попадает в профиль.

### Альтернативные сценарии

- Email уже существует: Система возвращает `409 Conflict`, система предлагает войти или восстановить пароль.

### Исключения

- Ошибка сети.
- Ошибка валидации в системе.

### Постусловия

- Новый аккаунт создан, пользователь авторизован.

### Критерии приёмки

- Подтверждение email обязательно.
- Пользователь видит профиль после регистрации.

---

## Use Case 3 — Изменение профиля пользователя

### Краткое описание

Пользователь обновляет личные данные в профиле.

### Акторы

- **Пользователь**
- **База данных**

### Предусловия

- Пользователь авторизован.

### Основной сценарий (Happy Path)

1. Пользователь открывает профиль.
2. Нажимает «Редактировать».
3. Вводит новые данные.
4. Система валидирует поля.
5. Отправляет запрос `PUT /api/user`.
6. Система обновляет данные и отображает профиль.

### Исключения

- Ошибка валидации на сервере → сообщение «Некорректные данные».
- Ошибка сервера → сообщение «Попробуйте позже».

### Постусловия

- Данные профиля обновлены.

### Критерии приёмки

- Все изменения сохраняются.
- Пользователь видит актуальную информацию.

---

## Use Case 4 — Восстановление пароля

### Краткое описание

Пользователь восстанавливает доступ к аккаунту при утере пароля.

### Акторы

- **Пользователь**
- **База данных**
- **E-mail сервис**

### Предусловия

- У пользователя есть аккаунт в системе.

### Основной сценарий (Happy Path)

1. Пользователь выбирает «Забыли пароль?».
2. Вводит email.
3. Система валидирует поле и отправляет `POST /api/user/recover`.
4. Система отправляет письмо.
5. Пользователь переходит по ссылке.
6. Вводит новый пароль.
7. Система валидирует и сохраняет пароль.
8. Пользователь попадает на страницу авторизации.

### Альтернативные сценарии

- Email не найден: Система возвращает `404`, пользователь видит сообщение и может перейти к регистрации.

### Исключения

- Ошибка сети.
- Ошибка сервера.

### Постусловия

- Пароль обновлён, пользователь может войти.

### Критерии приёмки

- Восстановление возможно только через подтверждение email.
- Пароль обновляется успешно.

---

## Use Case 5 — Добавление напоминания

### Краткое описание

Пользователь создаёт напоминание о событии в календаре.

### Акторы

- **Пользователь**
- **База данных**

### Предусловия

- Пользователь авторизован.

### Основной сценарий (Happy Path)

1. Пользователь открывает календарь.
2. Нажимает на ячейку.
3. Система отображает форму.
4. Пользователь вводит данные события.
5. Система валидирует форму.
6. Отправляется `POST /api/remind`.
7. Система подтверждает создание.

### Исключения

- Ошибка валидации данных.
- Ошибка сервера.

### Постусловия

- Напоминание создано и сохранено.

### Критерии приёмки

- Напоминание отображается в календаре.
- Пользователь получает подтверждение.

---
