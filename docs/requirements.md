# Technical Requirements

## 1. Анализ Use Cases

На основании диаграммы вариантов использования выделены следующие функциональные сценарии приложения:

### Аутентификация

- Регистрация нового пользователя.
- Авторизация существующего пользователя.
- Восстановление пароля с подтверждением по email.
- Удаление аккаунта.
- Переход в профиль пользователя.
- Редактирование профиля с возможностью изменения имени, фамилии, пола, даты рождения, описания и ссылки на Telegram.
- Отмена редактирования профиля.

### Работа с чатами

- Создание нового чата.
- Поиск по чатам.
- Открытие выбранного чата.
- Просмотр истории сообщений.
- Редактирование названия чата.
- Удаление чата.

### Взаимодействие с системой рекомендаций

- Ввод запроса для авторизованных и неавторизованных пользователей.
- Заполнение формы уточняющих данных (пол, возраст, описание, ссылка на пользователя).
- Получение текстового ответа с предложениями подарков.
- Возможность копировать ответ, перейти по предложенной ссылке и оценить качество результата.

### Напоминания

- Переход в календарь.
- Выбор даты для создания напоминания.
- Создание нового напоминания.
- Просмотр существующих напоминаний.
- Редактирование или удаление напоминания.
- Отмена редактирования.
- Заполнение полей: название события, описание, получатель и дата.

---

## 2. Технические требования

### Функциональные требования

1. **Регистрация и авторизация**

   - Система должна поддерживать регистрацию новых пользователей с подтверждением email.
   - Система должна сохранять данные пользователя в базе данных после успешной регистрации.
   - Система должна предоставлять возможность авторизации с использованием email и пароля.
   - Система должна выдавать пользователю JWT-токен после успешной авторизации для выполнения защищённых операций.
   - Система должна обеспечивать возможность удаления учётной записи пользователя.
   - Система должна предоставлять возможность изменения данных профиля пользователя.

2. **Профиль пользователя**

   - Система должна позволять пользователю редактировать свои личные данные: имя, фамилию, отчество, email, номер телефона и баланс.
   - Система должна требовать подтверждения действия при изменении данных.
   - Система должна выполнять проверку формата email и номера телефона при обновлении профиля.
   - Система должна сохранять изменения профиля в базе данных после успешной валидации.
   - Система должна предоставлять пользователю возможность просматривать собственные данные профиля.

3. **Работа с чатами**

   - Система должна позволять пользователю создавать новые чаты.
   - Система должна обеспечивать возможность редактирования и удаления чатов.
   - Система должна сохранять список сообщений каждого чата в базе данных.
   - Система должна предоставлять пользователю возможность просматривать список доступных чатов.
   - Система должна позволять пользователю отправлять и получать сообщения внутри чата.
   - Система должна обеспечивать удаление чата вместе с его сообщениями по запросу пользователя.

4. **Обработка запросов пользователей**

   - Система должна обрабатывать текстовые запросы пользователей для подбора подарков и предоставления рекомендаций.
   - Система должна ограничивать количество запросов от неавторизованных пользователей.
   - Система должна предоставлять персонализированные результаты для авторизованных пользователей.
   - Система должна формировать ответ в текстовом виде, который может содержать ссылки на подарки и магазины.
   - Система должна использовать встроенную языковую модель (LLM) для анализа и генерации ответов.
   - Система должна сохранять историю пользовательских запросов для последующего анализа.

5. **Работа с подарками**

   - Система должна позволять пользователю просматривать список доступных подарков.
   - Система должна предоставлять возможность фильтрации подарков по категории, цене, получателю и событию.
   - Система должна позволять добавлять выбранные подарки в список избранного.
   - Система должна обеспечивать возможность удаления подарков из списка избранного.
   - Система должна предоставлять пользователю детальную информацию о каждом подарке.
   - Система должна сохранять действия пользователя (просмотр, добавление, удаление) в истории активности.

6. **Поиск и фильтрация**

   - Система должна предоставлять пользователю возможность поиска по чатам, напоминаниям и подаркам.
   - Система должна поддерживать фильтрацию результатов поиска по дате, названию, категории и активности.
   - Система должна возвращать результаты поиска через REST API с использованием параметров запроса.
   - Система должна обеспечивать корректную сортировку найденных данных в зависимости от выбранных критериев.
   - Система должна обрабатывать ошибочные или пустые запросы с выдачей соответствующих уведомлений пользователю.

7. **Администрирование**

   - Система должна предоставлять администратору возможность просмотра всех пользователей и их активности.
   - Система должна обеспечивать возможность блокировки и удаления пользователей при нарушении правил использования.
   - Система должна ограничивать доступ к административным функциям только для пользователей с ролью администратора.
   - Система должна позволять администратору просматривать системную статистику (число пользователей, количество запросов и т.д.).
   - Система должна вести журнал административных действий для контроля изменений и аудита.

8. **Работа с напоминаниями**

   - Система должна позволять пользователю добавлять новые напоминания о событиях.
   - Система должна обеспечивать редактирование и удаление существующих напоминаний.
   - Система должна синхронизировать напоминания с локальным календарём пользователя.
   - Система должна отправлять уведомления пользователю за заданное время до наступления события.
   - Система должна предоставлять пользователю возможность просмотра списка всех напоминаний.
   - Система должна проверять корректность даты и времени при создании напоминания.
   - Система должна сохранять напоминания в базе данных и гарантировать их доставку в указанный срок.

### Нефункциональные требования

- Поддержка высокой доступности (uptime ≥ 99%).
- Минимальное время отклика API — до 1 секунды.
- Возможность горизонтального масштабирования.
- Безопасность данных.
- Система должна работать на Windows, macOS и мобильных устройствах.
- Интерфейс должен быть интуитивно понятным, с поддержкой русского языка.

---

## 3. Метрики производительности

| Метрика                                    | Целевое значение | Описание                                    |
| ------------------------------------------ | ---------------- | ------------------------------------------- |
| **Время отклика API**                      | ≤ 1 сек          | Среднее время ответа сервера на запрос      |
| **Время аутентификации**                   | ≤ 2 сек          | Авторизация пользователя с проверкой токена |
| **Доступность системы**                    | ≥ 99%            | Работа серверной части без простоев         |
| **Время загрузки чата**                    | ≤ 2 сек          | Отображение сообщений после открытия чата   |
| **Создание напоминания**                   | ≤ 2 сек          | Обработка данных и запись в базу            |
| **Обработка запроса к AI**                 | ≤ 25 сек         | Время получения рекомендаций от AI Engine   |
| **Количество одновременных пользователей** | ≥ 100            | Минимальная производственная нагрузка       |

---

## 4. Архитектурные принципы

1. **Архитектурный стиль** — клиент-сервер с REST API.

   - Клиент: Vue.js.
   - Сервер: Node.js (Express + TypeScript).
   - База данных: PostgreSQL & Redis.

2. **Слои системы:**

   - **Frontend (UI):** взаимодействие с пользователем, запросы к API, валидация данных.
   - **Backend (API Layer):** маршрутизация, логика, авторизация, валидация данных.
   - **Database Layer:** хранение пользователей, чатов, напоминаний.
   - **AI Layer (внешний сервис):** формирование рекомендаций подарков.

3. **Безопасность и управление сессиями**

   - JWT-токены для авторизации.
   - Шифрование паролей (bcrypt).
   - HTTPS для всех запросов.

4. **Масштабируемость**

   - Возможность горизонтального масштабирования серверов.
   - Поддержка контейнеризации (Docker).
   - Кэширование JWT через Redis.

5. **Принципы проектирования**
   - Разделение ответственности (SRP).
   - Использование асинхронных операций.
   - Модульность и возможность расширения.
   - Минимизация дублирования кода.
   - RESTful-навигация и единообразные ответы.
